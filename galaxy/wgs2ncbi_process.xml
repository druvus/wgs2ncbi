<tool id="wgs2ncbi_process" name="FASTA Index" version="1.0.0">
  <description>indexes sequence data</description>
  <command>
    bash '$__tool_directory__/wgs2ncbi_process.sh' '-conf $config_ini -prefix $prefix -authority gnl|$authority| -datafile $fasta -info $info -masks $masks -products $products -verbosity 0' '$gff3' '$out_file'
  </command>
  <inputs>
    <param name="fasta" format="fasta" type="data" label="FASTA sequences file" />
    <param name="prefix" type="text" label="prefix" help="The identifier prefix that was generated by NCBI, e.g. 'CR513_'" />
    <param name="authority" type="text" label="authority" help="The naming authority for locally generated identifiers, e.g. 'gnl|aceprd|'" />
    <param name="info" format="txt" type="data" label="info file" help="This file contains lines with key/value pairs that will be inserted in the FASTA headers. These are typically used for data about the assay and organism, e.g. 'organism=Mucuna pruriens'" />
    <param name="masks" format="txt" type="data" label="masks file" help="This file contains ranges to mask. Each line should contain the sequence (e.g. scaffold) identifier and then the start and end coordinates, e.g. 'contig_9825=54309..54363'"/>
    <param name="products" format="txt" type="data" label="products file" help="This file contains a mapping between 'incorrect' product names and corrected ones. Each pair of incorrect and corrected name is on a line, separated by an '=' sign" />
    <param name="gff3" format="zip" type="data" label="Indexed GFF3 file" />
  </inputs>
  <configfiles>
    <configfile name="config_ini">
; The preferred source whose annotations to use.
source=maker

; Feature types to retain during pre-processing.
feature=CDS
feature=gene
feature=five_prime_UTR
feature=three_prime_UTR
      
; Number of sequences to lump in one file. Must be less than or equal to 10,000
chunksize=5000

; Minimum length of sequences to retain. Must be greater than or equal to 200
minlength=200

; Number of sequences to write (used for testing). Set to 0 for all sequences.
limit=0

; Minimum length of introns to retain. Must be greater than or equal to 10. 
; In genes that have smaller introns all CDS features are lumped to create a 
; non-coding pseudogene.
minintron=10

; Location of the tbl2asn executable. If this is set to tbl2asn=tbl2asn then the 
; assumption is that it is found on the PATH.
tbl2asn=tbl2asn

; Verbosity. Can be 0, (errors only), 1 (also warnings), 2 (also info messages) or 
; 3 (also debugging messages)
verbosity=0

; Logging complexity. 0=only show log level and message; 1=also show fully qualified 
; method name, code file and line number
complexity=1  
    </configfile>
  </configfiles>  
  <outputs>
    <data name="out_file" format="zip" />
  </outputs>
  <help>
**What it does**

This tool is part of the WGS2NCBI pipeline, which prepares the annotated results of whole 
genome sequencing (WGS) for submission to NCBI. In this step of the pipeline, the 
genome sequences are processed:

- The sequence definition lines are enriched with the information from the **Info file**
- Any sequence fragments identified in the **Masks** file are blanked out with NNNs
- NCBI feature tables are generated, with sanitized product names generated using the
  mappings in the **Products file**

-----

**INI input files**

- **Project file** This file contains the project-level settings, such as the 
  the identifier prefix generated by NCBI and the naming authority prefix for internal
  IDs
- **Info file** Contains information about the assay, such as the organism that was
  sequenced, its sex, tissue, and so on
- **Masks file** Contains the coordinates of sequence fragments to mask, such as 
  adaptors, contaminations, and so on
- **Products file** Contains mappings between 'illegal' product names and sanitized ones

-----

**Input data files**

- **FASTA sequence file** Contains the genome sequence data in FASTA format. This file
  will contain multiple records, which might be contigs, scaffolds, or chromosomes. The
  first "word" of each FASTA record (so, the thing that comes immediately after the '>'
  sign) must match the names in the GFF3 annotation file exactly.
- **Indexed GFF3 file** Is a compressed archive of annotation files as produced by the
  `GFF3 Index` step.

  </help>
  <!--citations>
    <citation type="doi">10.1007/11732990_17</citation>
  </citations-->
</tool>
